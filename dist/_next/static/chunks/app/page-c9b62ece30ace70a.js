(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{5295:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>B});var n=s(5155),r=s(2115),l=s(4624),a=s(2085),i=s(2596),o=s(9688);function c(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];return(0,o.QP)((0,i.$)(t))}let d=(0,a.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),u=r.forwardRef((e,t)=>{let{className:s,variant:r,size:a,asChild:i=!1,...o}=e,u=i?l.DX:"button";return(0,n.jsx)(u,{className:c(d({variant:r,size:a,className:s})),ref:t,...o})});u.displayName="Button";var h=s(133);let m=0,x=new Map,f=e=>{if(x.has(e))return;let t=setTimeout(()=>{x.delete(e),v({type:"REMOVE_TOAST",toastId:e})},1e6);x.set(e,t)},g=(e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===t.toast.id?{...e,...t.toast}:e)};case"DISMISS_TOAST":{let{toastId:s}=t;return s?f(s):e.toasts.forEach(e=>{f(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===s||void 0===s?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===t.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==t.toastId)}}},p=[],w={toasts:[]};function v(e){w=g(w,e),p.forEach(e=>{e(w)})}function b(e){let{...t}=e,s=(m=(m+1)%Number.MAX_SAFE_INTEGER).toString(),n=()=>v({type:"DISMISS_TOAST",toastId:s});return v({type:"ADD_TOAST",toast:{...t,id:s,open:!0,onOpenChange:e=>{e||n()}}}),{id:s,dismiss:n,update:e=>v({type:"UPDATE_TOAST",toast:{...e,id:s}})}}function j(){let[e,t]=r.useState(w);return r.useEffect(()=>(p.push(t),()=>{let e=p.indexOf(t);e>-1&&p.splice(e,1)}),[e]),{...e,toast:b,dismiss:e=>v({type:"DISMISS_TOAST",toastId:e})}}let y=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,n.jsx)("div",{ref:t,className:c("rounded-lg border bg-card text-card-foreground shadow-sm",s),...r})});y.displayName="Card";let N=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,n.jsx)("div",{ref:t,className:c("flex flex-col space-y-1.5 p-6",s),...r})});N.displayName="CardHeader";let S=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,n.jsx)("div",{ref:t,className:c("text-2xl font-semibold leading-none tracking-tight",s),...r})});S.displayName="CardTitle";let k=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,n.jsx)("div",{ref:t,className:c("text-sm text-muted-foreground",s),...r})});k.displayName="CardDescription";let C=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,n.jsx)("div",{ref:t,className:c("p-6 pt-0",s),...r})});C.displayName="CardContent";let T=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,n.jsx)("div",{ref:t,className:c("flex items-center p-6 pt-0",s),...r})});T.displayName="CardFooter";var A=s(5273),E=s(646),R=s(5339),I=s(4788);function D(e){let{exerciseData:t,currentExerciseIndex:s,currentStep:l,onComplete:a,sentenceProgress:i}=e,{toast:o}=j(),[c,d]=(0,r.useState)(""),[h,m]=(0,r.useState)([]),[x,f]=(0,r.useState)(0),[g,p]=(0,r.useState)(!1),[w,v]=(0,r.useState)(!1),[b,D]=(0,r.useState)(!1),[_,O]=(0,r.useState)({correct:!1,errors:[]}),[L,P]=(0,r.useState)(!1),[M,F]=(0,r.useState)(!1),H=(0,r.useRef)([]),U=(0,r.useRef)(null),W=t[s],z=W.sentences[l].english,B=z.split(" ");(0,r.useEffect)(()=>{d(""),m(Array(B.length).fill("")),f(0),p(!1),v(!1),O({correct:!1,errors:[]}),F(!1),setTimeout(()=>{H.current[0]&&H.current[0].focus()},100)},[l,B.length,W]);let V=()=>{let e=new SpeechSynthesisUtterance(z);e.lang="en-US",e.rate=.8,window.speechSynthesis.speak(e)};(0,r.useEffect)(()=>{let e=setTimeout(()=>{V()},500);return()=>clearTimeout(e)},[l]);let G=()=>{for(let e=0;e<B.length;e++){let t=h[e],s=B[e];if(!t||!s||t.toLowerCase()!==s.toLowerCase())return!1}return!0};(0,r.useEffect)(()=>{if(g){let e=G();v(e),e&&_.errors.length>0&&(O({correct:!0,errors:[]}),D(!0),setTimeout(()=>{a(!0,[],[],M),D(!1)},4e3))}},[h,g]);let J=(e,t)=>{let s=[...h];if(s[e]=t,m(s),t.endsWith(" ")||t.length>=B[e].length&&t.length>1){let n=t.trim();s[e]=n,m(s),e===B.length-1&&n.length>=B[e].length?n.toLowerCase()!==B[e].toLowerCase()||g?g&&G()&&(v(!0),O({correct:!0,errors:[]})):setTimeout(()=>{var e;return null===(e=U.current)||void 0===e?void 0:e.focus()},100):e<B.length-1&&(f(e+1),setTimeout(()=>{var t;null===(t=H.current[e+1])||void 0===t||t.focus()},10))}},K=(e,t)=>{if(t.stopPropagation(),"Enter"===t.key){t.preventDefault(),g&&G()?(v(!0),O({correct:!0,errors:[]}),a(!0,[],[],M)):X();return}"Backspace"===t.key&&(!h[e]||""===h[e])&&e>0&&(t.preventDefault(),f(e-1),setTimeout(()=>{let t=H.current[e-1];if(t){var s;t.focus();let n=(null===(s=h[e-1])||void 0===s?void 0:s.length)||0;t.setSelectionRange(n,n)}},10))},X=()=>{p(!0);let e=[],t=h.map((t,s)=>t&&B[s]?t.toLowerCase()!==B[s].toLowerCase()?(e.push(s),{index:s,word:t,correctWord:B[s]}):null:(e.push(s),{index:s,word:t||"",correctWord:B[s]||""})).filter(Boolean),s=0===t.length;if(v(s),O({correct:s,errors:t}),!s&&e.length>0){let t=[...h];e.forEach(e=>{t[e]=""}),m(t);let s=e[0];f(s),setTimeout(()=>{H.current[s]&&H.current[s].focus()},50)}s?a(!0,[],[],M):a(!1,t.map(e=>e.correctWord),e,M)},Q=(e,t)=>{let s="";for(let n=0;n<Math.max(e.length,t.length);n++){if(n>=e.length){s+='缺少字母 "'.concat(t.slice(n),'"');break}if(n>=t.length){s+='多余字母 "'.concat(e.slice(n),'"');break}if(e[n]!==t[n]){s+="第 ".concat(n+1,' 个字母应为 "').concat(t[n],'" 而不是 "').concat(e[n],'"');break}}return s||"拼写错误"};return(0,n.jsxs)(y,{className:"w-full",children:[(0,n.jsxs)(N,{children:[(0,n.jsxs)(S,{className:"flex justify-between items-center text-2xl",children:["英语句子构建练习",(0,n.jsx)(u,{variant:"ghost",size:"icon",onClick:V,"aria-label":"播放音频",children:(0,n.jsx)(A.A,{className:"h-6 w-6"})})]}),(0,n.jsxs)(k,{className:"text-lg",children:['从单词 "',W.word,'" (',W.translation,") 开始构建句子",i&&(0,n.jsxs)("div",{className:"mt-2 text-sm",children:[(0,n.jsxs)("span",{children:["正确: ",i.correctCount," 次"]}),(0,n.jsxs)("span",{className:"ml-4",children:["错误: ",i.incorrectCount," 次"]})]})]})]}),(0,n.jsx)(C,{children:(0,n.jsxs)("div",{className:"mb-6",children:[(0,n.jsxs)("p",{className:"text-xl font-medium mb-3",children:["步骤 ",l+1,"/",W.sentences.length]}),(0,n.jsx)("p",{className:"text-muted-foreground mb-6 text-lg",children:W.sentences[l].chinese}),g&&w?(0,n.jsx)("div",{className:"flex flex-wrap gap-4 mb-10 justify-center",children:(0,n.jsx)("p",{className:"text-xl font-bold text-green-600",children:z})}):(0,n.jsx)("div",{className:"flex flex-wrap gap-4 mb-10",children:B.map((e,t)=>(0,n.jsxs)("div",{className:"relative",children:[(0,n.jsx)("input",{ref:e=>{H.current&&(H.current[t]=e)},value:h[t]||"",onChange:e=>J(t,e.target.value),onKeyDown:e=>K(t,e),className:"\n                    bg-transparent \n                    border-0 \n                    border-b \n                    focus:ring-0 \n                    focus:outline-none \n                    px-2 \n                    py-2 \n                    text-center\n                    ".concat(h[t]&&B[t]&&h[t].toLowerCase()===B[t].toLowerCase()?"border-green-500 text-green-600":g?"border-red-500 text-red-600":"border-gray-300 focus:border-primary","\n                  "),style:{width:"".concat(Math.max(10*e.length,60),"px")},placeholder:"",autoFocus:t===x,onFocus:()=>f(t)}),g&&(void 0===h[t]||void 0===B[t]||h[t].toLowerCase()!==B[t].toLowerCase())&&(0,n.jsx)("span",{className:"absolute -bottom-6 left-0 text-xs text-red-500 whitespace-nowrap",children:B[t]})]},t))}),g&&(0,n.jsxs)("div",{className:"mt-6 p-4 rounded-md bg-muted",children:[(0,n.jsx)("div",{className:"flex items-center gap-3 mb-3 text-lg",children:_.correct?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(E.A,{className:"h-6 w-6 text-green-500"}),(0,n.jsx)("span",{className:"font-medium text-green-600 text-lg",children:"正确！"})]}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(R.A,{className:"h-6 w-6 text-red-500"}),(0,n.jsx)("span",{className:"font-medium text-red-600 text-lg",children:"需要修正"})]})}),_.correct&&(0,n.jsx)("div",{className:"my-4 text-center",children:(0,n.jsx)("p",{className:"text-xl font-bold",children:z})}),_.errors.length>0&&(0,n.jsx)("ul",{className:"list-disc pl-6 space-y-2 text-base",children:_.errors.map((e,t)=>(0,n.jsxs)("li",{children:[(0,n.jsxs)("span",{className:"font-medium",children:["单词 ",e.index+1,":"]})," ",Q(e.word,e.correctWord)]},t))})]})]})}),(0,n.jsxs)(T,{className:"flex justify-between pt-6",children:[(0,n.jsxs)("div",{className:"flex gap-2",children:[(0,n.jsx)(u,{variant:"outline",onClick:V,className:"text-base px-4 py-5",children:"重新播放"}),(0,n.jsxs)(u,{variant:"outline",onClick:()=>{if(x<B.length){F(!0),o({title:"已使用语音提示",description:"本句子将不计入积分",variant:"default"});let e=B[x],t=new SpeechSynthesisUtterance(e);t.lang="en-US",t.rate=.7,window.speechSynthesis.speak(t),setTimeout(()=>{let t=new SpeechSynthesisUtterance(e);t.lang="en-US",t.rate=.6,window.speechSynthesis.speak(t)},1e3)}},className:"text-base px-4 py-5 flex items-center gap-1",disabled:g||w,children:[(0,n.jsx)(I.A,{className:"h-4 w-4"}),"语音提示"]})]}),(0,n.jsx)(u,{ref:U,onClick:()=>{g?w&&!b?(D(!0),setTimeout(()=>{a(!0,[],[],M),D(!1)},4e3)):w&&b?(a(!0,[],[],M),D(!1)):X():X()},className:"text-base px-6 py-5",disabled:b,children:g?w?b?"正在跳转...":"继续":"重新检查":"检查答案"})]})]})}let _={bird:"bɜːrd",hair:"heər",star:"stɑːr",red:"red",girl:"gɜːrl",go:"gəʊ",door:"dɔːr",free:"friː",a:"ə",is:"ɪz",flying:"ˈflaɪɪŋ",in:"ɪn",the:"\xf0ə",sky:"skaɪ",and:"\xe6nd",singing:"ˈsɪŋɪŋ",her:"hɜːr",long:"lɒŋ",black:"bl\xe6k",very:"ˈveri",beautiful:"ˈbjuːtɪfʊl",shining:"ˈʃaɪnɪŋ",little:"ˈlɪtl",dark:"dɑːrk","it's":"ɪts",apple:"ˈ\xe6pl",on:"ɒn",table:"ˈteɪbl",big:"bɪg",looks:"lʊks",sweet:"swiːt",smiling:"ˈsmaɪlɪŋ",happy:"ˈh\xe6pi",at:"\xe6t",friend:"frend",park:"pɑːrk",out:"aʊt",i:"aɪ",to:"tuː",play:"pleɪ",with:"wɪ\xf0",my:"maɪ",friends:"frendz",open:"ˈəʊpən",now:"naʊ",cat:"k\xe6t",walking:"ˈwɔːkɪŋ",am:"\xe6m",today:"təˈdeɪ",outside:"ˌaʊtˈsaɪd",so:"səʊ",will:"wɪl"};function O(e){let{word:t,translation:s,onComplete:l,wordProgress:a}=e,[i,o]=(0,r.useState)(""),[c,d]=(0,r.useState)(!1),[h,m]=(0,r.useState)(!1),[x,f]=(0,r.useState)(0),[g,p]=(0,r.useState)(!1),[w,v]=(0,r.useState)(0),b=(0,r.useRef)(null),j=(0,r.useRef)(null),I=(0,r.useRef)(null),D=(0,r.useRef)(null);(0,r.useEffect)(()=>{o(""),d(!1),m(!1),f(0),p(!1),v(0),setTimeout(()=>{I.current&&I.current.focus()},100)},[t]);let O=()=>{let e=new SpeechSynthesisUtterance(t);e.lang="en-US",e.rate=.8,window.speechSynthesis.speak(e)};(0,r.useEffect)(()=>{let e=setTimeout(()=>{O()},500);return()=>clearTimeout(e)},[t]);let L=()=>{d(!0),f(x+1);let e=i.toLowerCase().trim(),s=t.toLowerCase().trim(),n=e===s;if(m(n),n)b.current&&(b.current.currentTime=0,b.current.play().catch(e=>console.error("播放音效失败:",e))),setTimeout(()=>{l(!0)},1500);else{j.current&&(j.current.currentTime=0,j.current.play().catch(e=>console.error("播放音效失败:",e)));let t=0;for(let n=0;n<Math.min(e.length,s.length);n++)if(e[n]===s[n])t++;else break;v(Math.min(t,s.length-1)),p(!0)}},P=()=>{let e=i.toLowerCase().trim(),n=t.toLowerCase().trim(),r=0;for(let t=0;t<Math.min(e.length,n.length);t++)if(e[t]===n[t])r++;else break;let l="";for(let e=0;e<t.length;e++)e<r?l+='<span class="text-green-500">'.concat(t[e],"</span>"):e===r?l+='<span class="text-blue-500 font-bold">'.concat(t[e],"</span>"):e<=w?l+=t[e]:l+="_";let a="已输入正确: ".concat(r," 个字母");return a+=", 总长度: ".concat(t.length," 个字母"),w>=Math.floor(t.length/2)&&s&&(a+=", 中文: ".concat(s)),{textHint:a,visualHint:l}};return(0,n.jsxs)(y,{className:"w-full",children:[(0,n.jsx)("audio",{ref:b,src:"/sounds/correct.mp3",preload:"auto"}),(0,n.jsx)("audio",{ref:j,src:"/sounds/incorrect.mp3",preload:"auto"}),(0,n.jsxs)(N,{children:[(0,n.jsxs)(S,{className:"flex justify-between items-center text-2xl",children:["单词学习",(0,n.jsx)(u,{variant:"ghost",size:"icon",onClick:O,"aria-label":"播放音频",children:(0,n.jsx)(A.A,{className:"h-6 w-6"})})]}),(0,n.jsxs)(k,{className:"text-lg",children:["请拼写你听到的单词 ",s&&(0,n.jsxs)("span",{className:"font-medium",children:["(",s,")"]}),a&&(0,n.jsxs)("div",{className:"mt-2 text-sm",children:[(0,n.jsxs)("span",{children:["正确: ",a.correctCount," 次"]}),(0,n.jsxs)("span",{className:"ml-4",children:["错误: ",a.incorrectCount," 次"]})]})]})]}),(0,n.jsx)(C,{children:(0,n.jsxs)("div",{className:"mb-6",children:[(0,n.jsxs)("div",{className:"flex flex-col items-center gap-4 mb-10",children:[(0,n.jsx)("div",{className:"text-center mb-1",children:(0,n.jsx)("span",{className:"text-slate-400 text-sm",children:function(e){let t=_[e.toLowerCase().trim()]||"";return t?"/".concat(t,"/"):""}(t)})}),(0,n.jsx)("input",{ref:I,value:i,onChange:e=>o(e.target.value),onKeyDown:e=>{"Enter"!==e.key||(e.preventDefault(),c?h||(d(!1),o(""),setTimeout(()=>{I.current&&I.current.focus()},10)):L())},className:"\n                bg-transparent \n                border-0 \n                border-b \n                focus:ring-0 \n                focus:outline-none \n                px-2 \n                py-2 \n                text-center\n                text-xl\n                w-full\n                max-w-xs\n                ".concat(c?h?"border-green-500 text-green-600":"border-red-500 text-red-600":"border-gray-300 focus:border-primary","\n              "),placeholder:"输入单词",autoFocus:!0})]}),c&&(0,n.jsxs)("div",{className:"mt-6 p-4 rounded-md bg-muted",children:[(0,n.jsx)("div",{className:"flex items-center gap-3 mb-3 text-lg",children:h?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(E.A,{className:"h-6 w-6 text-green-500"}),(0,n.jsx)("span",{className:"font-medium text-green-600 text-lg",children:"正确！"})]}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(R.A,{className:"h-6 w-6 text-red-500"}),(0,n.jsx)("span",{className:"font-medium text-red-600 text-lg",children:"不正确，请再试一次"})]})}),!h&&g&&(0,n.jsxs)("div",{className:"mt-2 text-base",children:[(0,n.jsx)("div",{className:"font-medium text-center text-2xl mb-3",dangerouslySetInnerHTML:{__html:P().visualHint}}),(0,n.jsx)("p",{className:"text-center text-base",children:P().textHint}),(0,n.jsxs)("p",{className:"text-center mt-2 text-sm text-muted-foreground",children:["请根据提示继续输入，",(0,n.jsx)("span",{className:"text-blue-500 font-bold",children:"蓝色"})," 字母是下一个需要输入的"]})]})]})]})}),(0,n.jsxs)(T,{className:"flex justify-between pt-6",children:[(0,n.jsx)(u,{variant:"outline",onClick:O,className:"text-base px-6 py-5",children:"重新播放"}),(0,n.jsx)(u,{ref:D,onClick:()=>{c?h||(d(!1),o(""),setTimeout(()=>{I.current&&I.current.focus()},10)):L()},className:"text-base px-6 py-5",children:c?h?"正确！":"再试一次":"检查"})]})]})}let L=[1,3,7,14,30,60,90];function P(){return{words:{},sentences:{},currentExerciseIndex:0,currentStep:0,points:0}}function M(e){let t=Date.now();return Object.values(e).filter(e=>e.nextReview<=t)}var F=s(1778),H=s(9843);function U(e){let{wordProgress:t,sentenceProgress:s,onStartWordReview:l,onStartSentenceReview:a,onSkipReview:i}=e,[o,c]=(0,r.useState)([]),[d,h]=(0,r.useState)([]),[m,x]=(0,r.useState)(!1);return((0,r.useEffect)(()=>{let e=M(t),n=M(s);c(e),h(n),x(e.length>0||n.length>0)},[t,s]),m)?(0,n.jsxs)(y,{className:"w-full mb-8",children:[(0,n.jsxs)(N,{children:[(0,n.jsx)(S,{className:"text-2xl",children:"复习时间"}),(0,n.jsx)(k,{className:"text-lg",children:"以下内容需要复习，以加强记忆"})]}),(0,n.jsxs)(C,{children:[o.length>0&&(0,n.jsxs)("div",{className:"mb-6",children:[(0,n.jsx)("h3",{className:"text-xl font-medium mb-3",children:"单词复习"}),(0,n.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:o.slice(0,6).map(e=>(0,n.jsxs)(u,{variant:"outline",className:"justify-between p-4 h-auto",onClick:()=>l(e.word),children:[(0,n.jsx)("span",{className:"font-medium",children:e.word}),(0,n.jsxs)("span",{className:"text-sm text-muted-foreground",children:["上次练习: ",(0,F.m)(e.lastPracticed,{addSuffix:!0,locale:H.g})]})]},e.word))}),o.length>6&&(0,n.jsxs)("p",{className:"mt-2 text-sm text-muted-foreground",children:["还有 ",o.length-6," 个单词需要复习"]})]}),d.length>0&&(0,n.jsxs)("div",{children:[(0,n.jsx)("h3",{className:"text-xl font-medium mb-3",children:"句子复习"}),(0,n.jsx)("div",{className:"space-y-3",children:d.slice(0,3).map(e=>(0,n.jsxs)(u,{variant:"outline",className:"w-full justify-between p-4 h-auto text-left",onClick:()=>a(e.sentence),children:[(0,n.jsx)("span",{className:"font-medium",children:e.sentence}),(0,n.jsxs)("span",{className:"text-sm text-muted-foreground ml-2",children:["上次练习: ",(0,F.m)(e.lastPracticed,{addSuffix:!0,locale:H.g})]})]},e.sentence))}),d.length>3&&(0,n.jsxs)("p",{className:"mt-2 text-sm text-muted-foreground",children:["还有 ",d.length-3," 个句子需要复习"]})]})]}),(0,n.jsx)(T,{className:"flex justify-end pt-6",children:(0,n.jsx)(u,{variant:"outline",onClick:i,className:"text-base px-6 py-5",children:"稍后复习"})})]}):null}let W={bird:"鸟",hair:"头发",star:"星星",red:"红色的",girl:"女孩",go:"去",door:"门",free:"自由的/有空的",a:"一个",is:"是",flying:"飞行",in:"在...中",the:"这个/那个",sky:"天空",and:"和",singing:"歌唱",her:"她的",long:"长的",black:"黑色的",very:"非常",beautiful:"漂亮的",shining:"闪耀",little:"小的",dark:"黑暗的","it's":"它是",apple:"苹果",on:"在...上",table:"桌子",big:"大的",looks:"看起来",sweet:"甜的",smiling:"微笑",happy:"快乐的",at:"对着",friend:"朋友",park:"公园",out:"出去",i:"我",to:"去",play:"玩",with:"和...一起",my:"我的",friends:"朋友们",open:"开着的",now:"现在",cat:"猫",walking:"走",am:"是",today:"今天",outside:"外面",so:"所以",will:"将会"},z=[{word:"bird",translation:"鸟",sentences:[{english:"A bird",chinese:"一只鸟"},{english:"A bird is flying",chinese:"一只鸟在飞"},{english:"A bird is flying in the sky",chinese:"一只鸟在天空中飞翔"},{english:"The bird is flying and singing",chinese:"这只鸟在飞翔和歌唱"}]},{word:"hair",translation:"头发",sentences:[{english:"Her hair",chinese:"她的头发"},{english:"Her hair is long",chinese:"她的头发很长"},{english:"Her hair is long and black",chinese:"她的头发又长又黑"},{english:"Her hair is long black and very beautiful",chinese:"她的头发又长又黑，非常漂亮"}]},{word:"star",translation:"星星",sentences:[{english:"A star",chinese:"一颗星星"},{english:"A star is shining",chinese:"一颗星星在闪烁"},{english:"A star is shining in the sky",chinese:"一颗星星在天空中闪烁"},{english:"A little star is shining in the dark sky",chinese:"一颗小星星在黑夜的天空中闪烁"}]},{word:"red",translation:"红色的",sentences:[{english:"It's red",chinese:"它是红色的"},{english:"The apple is red",chinese:"这个苹果是红色的"},{english:"The red apple is on the table",chinese:"这颗红苹果在桌子上"},{english:"The red apple is big and looks very sweet",chinese:"这颗红苹果又大又看起来很甜"}]},{word:"girl",translation:"女孩",sentences:[{english:"A girl",chinese:"一个女孩"},{english:"A girl is smiling",chinese:"一个女孩在微笑"},{english:"A girl is smiling",chinese:"一个女孩在微笑"},{english:"A happy girl is smiling at her friend in the park",chinese:"一个快乐的女孩在公园里对她的朋友微笑"}]},{word:"go",translation:"去",sentences:[{english:"Go out",chinese:"出去"},{english:"I go out",chinese:"我出去"},{english:"I go out to play",chinese:"我出去玩"},{english:"I go out to play with my friends",chinese:"我和朋友一起出去玩"}]},{word:"door",translation:"门",sentences:[{english:"The door",chinese:"这扇门"},{english:"The door is open",chinese:"这扇门开着"},{english:"The door is open now",chinese:"这扇门现在是开着的"},{english:"The door is open now and a cat is walking out",chinese:"门现在开着，一只猫正走出来"}]},{word:"free",translation:"自由的/有空的",sentences:[{english:"I am free",chinese:"我是自由的"},{english:"I am free today",chinese:"我今天有空/我今天自由"},{english:"I am free today to play outside",chinese:"我今天有空可以出去玩"},{english:"I am free today so I will play outside with my friends",chinese:"我今天有空，所以我会和朋友一起出去玩"}]}];function B(){var e;let{toast:t}=j(),[s,l]=(0,r.useState)("sentence"),[a,i]=(0,r.useState)(0),[o,c]=(0,r.useState)(0),[d,m]=(0,r.useState)(""),[x,f]=(0,r.useState)([]),[g,p]=(0,r.useState)([]),[w,v]=(0,r.useState)(P()),b=z[a],y=(null==b?void 0:null===(e=b.sentences[o])||void 0===e?void 0:e.english)||"";(0,r.useEffect)(()=>{let e=function(){try{let e=localStorage.getItem("englishPracticeProgress");if(e)return JSON.parse(e)}catch(e){console.error("Failed to load progress:",e)}return P()}();e&&(v(e),i(e.currentExerciseIndex),c(e.currentStep))},[]);let N=e=>{v(e),function(e){try{localStorage.setItem("englishPracticeProgress",JSON.stringify(e))}catch(e){console.error("Failed to save progress:",e)}}(e)},S=e=>{let s={...e};if(o<b.sentences.length-1)c(o+1),s.currentStep=o+1;else if(a<z.length-1){let e=a+1;i(e),c(0),s.currentExerciseIndex=e,s.currentStep=0,t({title:"已完成当前练习组",description:'现在开始练习单词 "'.concat(z[e].word,'" (').concat(z[e].translation,")"),variant:"default"})}else t({title:"恭喜！",description:"你已完成所有练习。你可以继续复习之前的内容。",variant:"default"});N(s)};return(0,n.jsxs)("div",{className:"container mx-auto py-8 max-w-4xl",children:["sentence"===s&&(0,n.jsx)(U,{wordProgress:w.words,sentenceProgress:w.sentences,onStartWordReview:e=>{m(e),l("word");let t={...w};t.words[e]&&(t.words[e].inReview=!0,N(t))},onStartSentenceReview:e=>{for(let t=0;t<z.length;t++)for(let s=0;s<z[t].sentences.length;s++)if(z[t].sentences[s].english===e){i(t),c(s),l("sentence");let n={...w};n.sentences[e]&&(n.sentences[e].inReview=!0,N(n));return}},onSkipReview:()=>{let e={...w},s=Date.now();Object.keys(e.words).forEach(t=>{let n=e.words[t];n.nextReview<=s&&(n.nextReview=s+36e5)}),Object.keys(e.sentences).forEach(t=>{let n=e.sentences[t];n.nextReview<=s&&(n.nextReview=s+36e5)}),N(e),t({title:"复习已推迟",description:"复习项已推迟1小时，稍后会再次提醒你。",variant:"default"}),l("sentence")}}),(0,n.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,n.jsxs)("div",{className:"bg-primary/10 px-4 py-2 rounded-md flex items-center",children:[(0,n.jsx)("span",{className:"font-medium text-primary mr-2",children:"积分："}),(0,n.jsx)("span",{className:"text-lg font-bold",children:w.points||0})]}),(0,n.jsxs)(u,{variant:"outline",size:"sm",onClick:()=>{confirm("确定要重置所有学习进度吗？这将删除所有记录的学习数据。")&&(N(P()),i(0),c(0),l("sentence"),t({title:"进度已重置",description:"所有学习进度已被重置。",variant:"default"}))},className:"flex items-center gap-1",children:[(0,n.jsx)(h.A,{className:"h-4 w-4"}),"重置进度"]})]}),"sentence"===s&&b&&(0,n.jsx)(D,{exerciseData:z,currentExerciseIndex:a,currentStep:o,onComplete:function(e,s,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a={...w};!a.sentences[y]&&(a.sentences[y]={sentence:y,correctCount:0,incorrectCount:0,lastPracticed:Date.now(),nextReview:Date.now(),level:0,inReview:!1,wordErrors:[]}),a.sentences[y]=function(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],n=Date.now(),r={...e};t?(r.correctCount+=1,r.level<L.length-1&&(r.level+=1),r.wordErrors=[]):(r.incorrectCount+=1,r.level=Math.max(0,r.level-1),r.wordErrors=[...new Set([...r.wordErrors,...s])]),r.lastPracticed=n;let l=L[r.level];return r.nextReview=n+864e5*l,r}(a.sentences[y],e,s),e?(r?t({title:"句子正确",description:"由于使用了语音提示，本句子不计入积分",variant:"default"}):(a.points=(a.points||0)+1,t({title:"恭喜获得积分",description:"句子正确，积分 +1！当前积分：".concat(a.points),variant:"default"})),S(a)):(f(s),p(n),s.length>0&&(m(s[0]),l("word")),N(a))},sentenceProgress:w.sentences[y]}),"word"===s&&d&&(0,n.jsx)(O,{word:d,translation:(e=>{let t=e.toLowerCase().trim();if(W[t])return W[t];if(t.endsWith("s")&&W[t.slice(0,-1)])return W[t.slice(0,-1)];if(t.endsWith("ing")&&W[t.slice(0,-3)])return W[t.slice(0,-3)]+"（进行中）";if(t.endsWith("ed")&&W[t.slice(0,-2)])return W[t.slice(0,-2)]+"（过去式）";for(let e of z)if(e.word.toLowerCase()===t)return e.translation;for(let e of z)for(let s of e.sentences)if(s.english.toLowerCase().split(/\s+/).some(e=>e.replace(/[.,!?]/g,"")===t))return e.translation+"（相关主题）";return"未知单词"})(d),onComplete:e=>{let s={...w};!s.words[d]&&(s.words[d]={word:d,correctCount:0,incorrectCount:0,lastPracticed:Date.now(),nextReview:Date.now(),level:0,inReview:!1}),s.words[d]=function(e,t){let s=Date.now(),n={...e};t?(n.correctCount+=1,n.level<L.length-1&&(n.level+=1)):(n.incorrectCount+=1,n.level=Math.max(0,n.level-1)),n.lastPracticed=s;let r=L[n.level];return n.nextReview=s+864e5*r,n}(s.words[d],e),N(s);let n=x.filter(e=>e!==d);n.length>0?(f(n),m(n[0])):(t({title:"单词学习完成",description:"现在让我们再次尝试完成整个句子。",variant:"default"}),l("sentence"))},wordProgress:w.words[d]})]})}},8036:(e,t,s)=>{Promise.resolve().then(s.bind(s,5295))}},e=>{var t=t=>e(e.s=t);e.O(0,[581,441,684,358],()=>t(8036)),_N_E=e.O()}]);